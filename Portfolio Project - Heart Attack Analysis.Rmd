---
title: "Portfolio"
author: "Jehwan Bang"
date: "18/07/2021"
output:
  html_document:
    df_print: paged
---

AGE - Age of the patient
SEX - Sex of the patient, where (0:female , 1: male)
CP - Chest pain type, where (0: typical angina, 1: atypical angina, 
2: non-anginal pain, 3: asymptomatic)
TRTBPS - Resting blood pressure in (MM|HG)
CHOL - Cholestrol in (MG|HG) fetched via bmi sensor
FBS - Prediabetes (fasting blood sugar > 120 MG/DL), where (0:false, 1:true)
RESTECG - Resting electrocardiographic results, where (0: normal, 1: having ST-T wave abnormality (T wave inversions and/or ST elevation or depression of > 0.05 mV), 2: showing probable or definite left ventricular hypertrophy by Estes' criteria
THALACH -Maximum heart rate achieved
EXANG - Exercise induced angina, where (0: no, 1: yes) 
OLDPEAK - Previous peak
SLP - Slope
CAA - Number of major vessels (0-4)
THALL - Thalium stress test result (0,3)
OUTPUT - Target variable, where (0: less chance of heart attack, 1: more chance of heart attack)


install.packages("dplyr")
install.packages("ggplot2")
install.packages("highcharter")
```{r}
nm <- suppressPackageStartupMessages  # no message
setwd("C:/Users/je111/Downloads")
nm(library(dplyr))
nm(library(ggplot2))
nm(library(highcharter))
heart = read.csv("heart.csv",header=TRUE)
head(heart)
```


```{r}
summary(heart)
```

```{r}
str(heart)
```
Data Type is int except for the oldpeak which is num.


```{r}
glimpse(heart)
```



```{r}
heart <- unique(heart)
glimpse(heart)
```

We do see that one duplicate is removed from 303 Rows to 302 Rows.
```{r}

nu_var <- heart %>% dplyr::select("age","trtbps","chol","thalachh","oldpeak")
cat_var <- heart %>% dplyr::select("sex","cp","fbs","restecg","exng","slp","caa","thall","output")

names <- c(1:9)
cat_var[,names] <-lapply(cat_var[,names],factor)
str(cat_var)

```

SEX - Sex of the patient, where (0:female , 1: male)

```{r}
new_sex_str = function(bool_var){
  char_list = c(1, length(bool_var))
  for (i in 1:length(bool_var)) {
    var = bool_var[i]
    nchar = 'unknown'  
    
    if(var == 1){
        nchar = '1: male'}
    else{
        nchar = '0: female'}
      
     char_list[i] = nchar}
    
    return(char_list)
}

heart_sex <- heart %>% 
    select(sex) %>%
    group_by(sex) %>%
    summarise(Count = n()) %>%
    arrange(Count) %>%
    mutate(
        gender = new_sex_str(sex),
        percentage = paste(round(Count / sum(Count) * 100, 1), "%")
    )


heart_sex %>%
  hchart(type = "pie", hcaes(x = paste(gender, ' \t(', percentage, ')' ), y = Count)) %>%
    hc_xAxis(categories = paste(heart_sex$gender, ' (', heart_sex$percentage, ')' )) %>%
    hc_title(text = "Gender (0:female , 1: male) (SEX)") %>%
    hc_add_theme(hc_theme_google()) 

```

Chest Pain (CP)
CP - Chest pain type, where (0: typical angina, 1: atypical angina, 
2: non-anginal pain, 3: asymptomatic)
```{r}
new_cp_str = function(bool_var){
  char_list = c(1, length(bool_var))
  for (i in 1:length(bool_var)) {
    var = bool_var[i]
    nchar = 'unkown'  
    
    if(var == 0){
        nchar = '0: typical angina'}
      
    if(var == 1){
        nchar = '1: atypical angina'}
      
    if(var == 2){
        nchar = '2: non-anginal pain'}
      
    if(var == 3){
        nchar = '3: asymptomatic'}
      
     char_list[i] =  nchar}
    
    return(char_list)
 }


heart_cp <- heart %>% 
    select(cp) %>%
    group_by(cp) %>%
    summarise(Count = n()) %>%
    arrange(Count) %>%
    mutate(cp_str = new_cp_str(cp),
        percentage = paste(round(Count / sum(Count) * 100, 1), "%"))

heart_cp %>%
  hchart(type = "pie", hcaes(x = paste(cp_str, ' \t(', percentage, ')' ), y = Count)) %>%
    hc_xAxis(categories = paste(heart_cp$cp_str, ' (', heart_cp$percentage, ')' )) %>%
    hc_title(text = 'Chest Pain (CP)') %>%
    hc_add_theme(hc_theme_google()) %>%
    hc_chart(options3d=list(enabled=TRUE, alpha=0, beta=0)) %>% 
    hc_plotOptions(pie=list(innerSize= 100, depth= 50))
```



Fasting Blood Suger (FBS)
FBS - Prediabetes (fasting blood sugar > 120 MG/DL), where (0:false, 1:true)
```{r}
new_fbs_str = function(bool_var){
  char_list = c(1, length(bool_var))
  for (i in 1:length(bool_var)) {
    var = bool_var[i]
    nchar = 'unknown'  
    
    if(var == 1){
        nchar = '1: prediabetes (fbs > 120 mg/d)'}
    else{
        nchar = '0: normal'}
      
     char_list[i] =  nchar}
    
    return(char_list)
}



heart_fbs <- heart %>% 
    select(fbs) %>%
    group_by(fbs) %>%
    summarise(Count = n()) %>%
    arrange(Count) %>%
    mutate(fbs_str = new_fbs_str(fbs),
        percentage = paste(round(Count / sum(Count) * 100, 1), "%")
    )

heart_fbs %>%
  hchart(type = "pie", hcaes(x = paste(fbs_str, ' \t(', percentage, ')' ), y = Count)) %>%
    hc_xAxis(categories = paste(new_fbs_str(heart_fbs$fbs_str), ' (', heart_fbs$percentage, ')' )) %>%
    hc_title(text = 'Fasting Blood Sugar (FBS)') %>%
    hc_add_theme(hc_theme_google()) %>%
    hc_chart(options3d=list(enabled=TRUE, alpha=0)) %>% 
    hc_plotOptions(pie=list(innerSize= 100, 
                            depth= 50))
```
Resting Electrocardiographic Results (RESTECG)
RESTECG - Resting electrocardiographic results, where (0: normal, 1: having ST-T wave abnormality (T wave inversions and/or ST elevation or depression of > 0.05 mV), 2: showing probable or definite left ventricular hypertrophy by Estes' criteria

```{r}
new_restecg_str = function(bool_var){
  char_list = c(1, length(bool_var))
  for (i in 1:length(bool_var)) {
    var = bool_var[i]
    nchar = 'unknown'  
    
    if(var == 0){
        nchar = '0: normal'}
    if(var == 1){
        nchar = '1: having ST-T wave abnormality (T wave inversions and/or ST elevation or depression of > 0.05 mV)'}
    if(var == 2){
        nchar = "2: showing probable or definite left ventricular hypertrophy by Estes' criteria"}
      
     char_list[i] =  nchar
   }
    
    return(char_list)
 }

heart_restecg <- heart %>% 
    select(restecg) %>%
    group_by(restecg) %>%
    summarise(Count = n()) %>%
    arrange(Count) %>%
    mutate(restecg_str = new_restecg_str(restecg),
        percentage = paste(round(Count / sum(Count) * 100, 1), "%")
    )

heart_restecg %>%
  hchart(type = "pie", hcaes(x = paste(restecg_str, ' \t(', percentage, ')' ), y = Count)) %>%
    hc_xAxis(categories = paste(heart_restecg$restecg_str, ' (', heart_restecg$percentage, ')' )) %>%
    hc_title(text = 'Resting Electrocardiographic Results (RESTECG)') %>%
    hc_add_theme(hc_theme_google()) %>%
    hc_chart(options3d=list(enabled=TRUE, alpha=0)) %>% 
    hc_plotOptions(pie=list(innerSize= 100, 
                            depth= 50))

```
EXANG - Exercise induced angina, where (0: no, 1: yes)
```{r}
new_exng_str = function(bool_var){
  char_list = c(1, length(bool_var))
  for (i in 1:length(bool_var)) {
    var = bool_var[i]
    nchar = 'unknown'  
    
    if(var == 1){
        nchar = 'yes'}
    else{
        nchar = 'no'}
      
     char_list[i] =  nchar}
    
    return(char_list)
 }

heart_exng <- heart %>% 
    select(exng) %>%
    group_by(exng) %>%
    summarise(Count = n()) %>%
    arrange(Count) %>%
    mutate(
        exng_txt = new_exng_str(exng),
        percentage = paste(round(Count / sum(Count) * 100, 1), "%")
    )
heart_exng %>%
  hchart(type = "pie", hcaes(x = paste(exng_txt, ' \t(', percentage, ')' ), y = Count)) %>%
    hc_xAxis(categories = paste(heart_exng$exng_txt, ' (', heart_exng$percentage, ')' )) %>%
    hc_title(text = 'Exercise induced angina, where (0: no, 1: yes) (EXNG)') %>%
    hc_add_theme(hc_theme_google())


```


SLP - Slope
```{r}
heart_slp <- heart %>% 
    select(slp) %>%
    group_by(slp) %>%
    summarise(Count = n()) %>%
    arrange(Count) %>%
        mutate(
        percentage = paste(round(Count / sum(Count) * 100, 1), "%")
    )


heart_slp %>%
  hchart(type = "pie", hcaes(x = paste(slp, ' \t(', percentage, ')' ), y = Count)) %>%
    hc_xAxis(categories = paste(heart_slp$slp, ' (', heart_slp$percentage, ')' )) %>%
    hc_title(text = 'slp') %>%
    hc_add_theme(hc_theme_google()) %>%
    hc_chart(options3d=list(enabled=TRUE, alpha=0)) %>% 
    hc_plotOptions(pie=list(innerSize= 100, 
                            depth= 50))
```
CAA - Number of major vessels (0-4)
```{r}
heart_caa <- heart %>% 
    select(caa) %>%
    group_by(caa) %>%
    summarise(Count = n()) %>%
    arrange(Count) %>%
        mutate(
        percentage = paste(round(Count / sum(Count) * 100, 1), "%")
    )


heart_caa %>%
  hchart(type = "pie", hcaes(x = paste(caa, ' \t(', percentage, ')' ), y = Count)) %>%
    hc_xAxis(categories = paste(heart_caa$caa, ' (', heart_caa$percentage, ')' )) %>%
    hc_title(text = 'Number of Major Vessels (0-4) (CAA)') %>%
    hc_add_theme(hc_theme_google()) %>%
    hc_chart(options3d=list(enabled=TRUE, alpha=0)) %>% 
    hc_plotOptions(pie=list(innerSize= 100, 
                            depth= 50))
```

THALL - Thalium stress test result (0,3)
```{r}
heart_thall <- heart %>% 
    select(thall) %>%
    group_by(thall) %>%
    summarise(Count = n()) %>%
    arrange(Count) %>%
        mutate(
        percentage = paste(round(Count / sum(Count) * 100, 1), "%")
    )
heart_thall %>%
  hchart(type = "pie", hcaes(x = paste(thall, ' \t(', percentage, ')' ), y = Count)) %>%
    hc_xAxis(categories = paste(heart_thall$thall, ' (', heart_thall$percentage, ')' )) %>%
    hc_title(text = 'Thalium stress test result (0,3) (THALL)') %>%
    hc_add_theme(hc_theme_google()) %>%
    hc_chart(options3d=list(enabled=TRUE, alpha=0)) %>% 
    hc_plotOptions(pie=list(innerSize= 100, 
                            depth= 50))
```
Heart Attack (OUTPUT)
OUTPUT - Target variable, where (0: less chance of heart attack, 1: more chance of heart attack)
```{r}
new_output_str = function(bool_var){
  char_list = c(1, length(bool_var))
  for (i in 1:length(bool_var)) {
    var = bool_var[i]
    nchar = 'unknown'  

    if(var == 0){
        nchar = '0: Normal'}
      
    if(var == 1){
        nchar = '1: Heart Attack'}
      
     char_list[i] =  nchar}
    
    return(char_list)
 }

heart_output <- heart %>% 
    select(output) %>%
    group_by(output) %>%
    summarise(Count = n()) %>%
    arrange(Count) %>%
    mutate(
        heart_attack = new_output_str(output),
        percentage = paste(round(Count / sum(Count) * 100, 1), "%")
    )


heart_output %>%
  hchart(type = "pie", hcaes(x = paste(heart_attack, ' \t(', percentage, ')' ), y = Count)) %>%
    hc_xAxis(categories = paste(heart_output$heart_attack, ' (', heart_output$percentage, ')' )) %>%
    hc_title(text = 'Heart Attack (0: less chance, 1: more chance (OUTPUT)') %>%
    hc_add_theme(hc_theme_google())  

```


```{r}
print_histogram = function(name, title){
   keeps <- c(name, 'output')
   frame = heart[ , (names(heart) %in% keeps)]

  normal_chart <- hchart(frame[, (names(frame) %in% name)], type = "column") %>%
    hc_title(text= title) %>%
    hc_xAxis(title = name) %>%
    hc_chart(options3d=list(enabled=TRUE, alpha=0, beta=0, 
                            depth=100, viewDistance=20)) %>% 
    hc_plotOptions(column=list(depth= 100))
    
   htmltools::tagList(normal_chart)

}

```
```{r}
summary(heart$age) 
```
```{r}
print_histogram('age', 'Age')
```
It is close to normally distributed
```{r}
summary(heart$chol)
```
```{r}
print_histogram('chol', 'Cholestoral')
```
It is skewed to the right
```{r}
summary(heart$thalachh)
```
```{r}
print_histogram('thalachh', 'Maximum Heart Rate Achieved')
```
It is skewed to the left
```{r}

summary(heart$trtbps)    
```


```{r}
print_histogram('trtbps', 'Resting Blood Pressure')
```
It is skewed to the right

```{r}
summary(heart$oldpeak)
```


```{r}

print_histogram('oldpeak', 'Old Peak')
```

It is skewed to the right

```{r}
print_dense_histogram = function(name, title){
    
    keeps <- c(name, 'output')
    frame = heart[ , (names(heart) %in% keeps)]

    normal <- frame %>% filter(output == 0)
    heart_attack <- frame %>% filter(output == 1)

   dense_plot <- hchart(
      density(normal[, (names(normal) %in% name)]), type = "area", 
      color = "green", 
       name = "Normal"
    ) %>%
      hc_add_series(
      density(heart_attack[, (names(heart_attack) %in% name)]), type = "area",
      color = "red", 
      name = "Heart Attack"
   ) %>%
    hc_title(text= title) %>%
    hc_xAxis(title = name) %>%
    hc_add_theme(hc_theme_google())
     
  htmltools::tagList(dense_plot)
    
}
```




```{r}
print_dense_histogram('age', 'Age')
```
We do see that there is more heart attack for age (20-53 and 70-80+)
```{r}
print_dense_histogram('chol', 'Cholestoral')
```
Low cholestrol (180-250)and high cholestroal (over 500) is more prone to heart attack
```{r}
print_dense_histogram('thalachh', 'Maximum Heart Rate Achieved')
```
Maximum heart rate after 150 is more prone to heart attack
```{r}
print_dense_histogram('trtbps', 'Resting Blood Pressure')
```
Resting blood pressure less than 140 is more prone to heart attack
```{r}
print_dense_histogram('oldpeak', 'Old Peak')
```
Less old peak is more prone to heart attack


```{r}
cp_heart <- heart %>%
        select(output, cp) %>%
        group_by(output, cp) %>%
        summarize(count = n()) %>%
        mutate(
            cp_str = new_cp_str(cp),
            is_trouble = new_output_str(output),
            percentage = as.integer(round(count / sum(count) * 100, 1)),
            percentage_str = paste0(round(count / sum(count) * 100, 1), "%")
        )


cp_heart %>%
  hchart(type = "column", hcaes(x = paste(cp_str, ' \t(', percentage_str, ')' ), y=count, group = is_trouble)) %>%
    hc_plotOptions(column = list(stacking = "percent")) %>%
    hc_xAxis(title = "Chest Pain", categories = cp_heart$cp_str) %>%
    hc_yAxis(title = list(text = 'percent')) %>%
    hc_title(text = 'Chest Pain effect on Heart Attack') %>%
    hc_add_theme(hc_theme_google()) %>%
    hc_chart(options3d=list(enabled=TRUE, 
                            depth=100, viewDistance=25)) %>% 
    hc_plotOptions(column=list(depth= 100))
```
Chest pain type 1-3 is more prone to heart attack
```{r}
gender_heart <- heart %>%
        select(output, sex) %>%
        group_by(output, sex) %>%
        summarize(count = n()) %>%
        mutate(
            gender = new_sex_str(sex),
            is_trouble = new_output_str(output),
            percentage = as.integer(round(count / sum(count) * 100, 1)),
            percentage_str = paste0(round(count / sum(count) * 100, 1), "%")
    )


gender_heart %>%
  hchart(type = "column", hcaes(x = paste(gender, ' \t(', percentage_str, ')' ), y=count, group = is_trouble)) %>%
    hc_plotOptions(column = list(stacking = "percent")) %>%
    hc_xAxis(title = "Gender", categories = gender_heart$gender) %>%
    hc_yAxis(title = list(text = 'percent')) %>%
    hc_title(text = 'Gender effect on Heart Attack') %>%
    hc_add_theme(hc_theme_google()) %>%
    hc_chart(options3d=list(enabled=TRUE,
                            depth=100, viewDistance=25)) %>% 
    hc_plotOptions(column=list(depth= 100))
```
Female is more prone to heart attack
```{r}
exng_heart <- heart %>%
        select(output, exng) %>%
        group_by(output, exng) %>%
        summarize(count = n()) %>%
        mutate(
            exng_str = new_exng_str(exng),
            is_trouble = new_output_str(output),
            percentage = as.integer(round(count / sum(count) * 100, 1)),
            percentage_str = paste0(round(count / sum(count) * 100, 1), "%")
        )


exng_heart %>%
  hchart(type = "column", hcaes(x = paste(exng_str, ' \t(', percentage_str, ')' ), y=count, group = is_trouble)) %>%
    hc_plotOptions(column = list(stacking = "percent")) %>%
    hc_xAxis(title = "Exercise Induced Angina", categories = exng_heart$exng_str) %>%
    hc_yAxis(title = list(text = 'percent')) %>%
    hc_title(text = 'Exercise Induced Angina effect on Heart Attack') %>%
    hc_add_theme(hc_theme_google()) %>%
    hc_chart(options3d=list(enabled=TRUE, 
                            depth=100, viewDistance=25)) %>% 
    hc_plotOptions(column=list(depth= 100))
```
No exercise induced angina is more prone to heart attack
```{r}
fbs_heart <- heart %>%
        select(output, fbs) %>%
        group_by(output, fbs) %>%
        summarize(count = n()) %>%
        mutate(
            fbs_str = new_fbs_str(fbs),
            is_trouble = new_output_str(output),
            percentage = as.integer(round(count / sum(count) * 100, 1)),
            percentage_str = paste(round(count / sum(count) * 100, 1), "%")
        )


fbs_heart %>%
  hchart(type = "column", hcaes(x = paste(fbs_str, ' \t(', percentage_str, ')' ), y=count, group = is_trouble)) %>%
    hc_plotOptions(column = list(stacking = "percent")) %>%
    hc_xAxis(title = "Fasting Blood Sugar", categories = fbs_heart$fbs_str) %>%
    hc_yAxis(title = list(text = 'percent')) %>%
    hc_title(text = 'Fasting Blood Sugar effect on Heart Attack') %>%
    hc_add_theme(hc_theme_google()) %>%
    hc_chart(options3d=list(enabled=TRUE, 
                            depth=100, viewDistance=25)) %>% 
    hc_plotOptions(column=list(depth= 100))
```
fbs is not really impacting heart attack much
```{r}
restecg_heart <- heart %>%
        select(output, restecg) %>%
        group_by(output, restecg) %>%
        summarize(count = n()) %>%
        mutate(
            res_str = new_restecg_str(restecg),
            is_trouble = new_output_str(output),
            percentage = as.integer(round(count / sum(count) * 100, 1)),
            percentage_str = paste0(round(count / sum(count) * 100, 1), "%")
        )


restecg_heart %>%
  hchart(type = "column", hcaes(x = paste(res_str, ' \t(', percentage_str, ')' ), y=count, group = is_trouble)) %>%
    hc_plotOptions(column = list(stacking = "percent")) %>%
    hc_xAxis(title = "Resting Electrocardiographic Results", categories = restecg_heart$res_str) %>%
    hc_yAxis(title = list(text = 'percent')) %>%
    hc_title(text = 'Resting Electrocardiographic effect on Heart Attack') %>%
    hc_add_theme(hc_theme_google()) %>%
    hc_chart(options3d=list(enabled=TRUE, 
                            depth=100, viewDistance=25)) %>% 
    hc_plotOptions(column=list(depth= 100))
```
Resting electrocardiographic 2 is less risky to heart attack
```{r}
slp_heart <- heart %>%
        select(output, slp) %>%
        group_by(output, slp) %>%
        summarize(count = n()) %>%
        mutate(
            slp_str =  slp,
            is_trouble = new_output_str(output),
            percentage = as.integer(round(count / sum(count) * 100, 1)),
            percentage_str = paste0(round(count / sum(count) * 100, 1), "%")
        )


slp_heart %>%
  hchart(type = "column", hcaes(x = paste(slp_str, ' \t(', percentage_str, ')' ), y=count, group = is_trouble)) %>%
    hc_plotOptions(column = list(stacking = "percent")) %>%
    hc_xAxis(title = "Slope", categories = slp_heart$slp_str) %>%
    hc_yAxis(title = list(text = 'percent')) %>%
    hc_title(text = 'Slope effect on Heart Attack') %>%
    hc_add_theme(hc_theme_google()) %>%
    hc_chart(options3d=list(enabled=TRUE,  
                            depth=100, viewDistance=25)) %>% 
    hc_plotOptions(column=list(depth= 100))

```
slope 2 is more prone to heart attack
```{r}
caa_heart <- heart %>%
        select(output, caa) %>%
        group_by(output, caa) %>%
        summarize(count = n()) %>%
        mutate(
            caa_str = caa,
            is_trouble = new_output_str(output),
            percentage = as.integer(round(count / sum(count) * 100, 1)),
            percentage_str = paste0(round(count / sum(count) * 100, 1), "%")
        )


caa_heart %>%
    hchart(type = "column", hcaes(x = paste(caa_str, ' \t(', percentage_str, ')' ), y=count, group = is_trouble)) %>%
    hc_plotOptions(column = list(stacking = "percent")) %>%
    hc_xAxis(title = "Number of Major Vessels (0-4)", categories = caa_heart$caa_str) %>%
    hc_yAxis(title = list(text = 'percent')) %>%
    hc_title(text = 'Major Vessels (caa) effect on Heart Attack') %>%
    hc_add_theme(hc_theme_google()) %>%
    hc_chart(options3d=list(enabled=TRUE,
                            depth=100, viewDistance=25)) %>% 
    hc_plotOptions(column=list(depth= 100))
```
We do see that major vessels 0 and 4 is more prone to heart attack and 1-3 is less risky to heart attack
```{r}
thall_heart <- heart %>%
        select(output, thall) %>%
        group_by(output, thall) %>%
        summarize(count = n()) %>%
        mutate(
            thall_str = thall,
            is_trouble = new_output_str(output),
            percentage = as.integer(round(count / sum(count) * 100, 1)),
            percentage_str = paste0(round(count / sum(count) * 100, 1), "%")
        )


thall_heart %>%
    hchart(type = "column", hcaes(x = paste(thall_str, ' \t(', percentage_str, ')' ), y=count, group = is_trouble)) %>%
    hc_plotOptions(column = list(stacking = "percent")) %>%
    hc_xAxis(title = "Thall(0-3)", categories = thall_heart$thall_str) %>%
    hc_yAxis(title = list(text = 'percent')) %>%
    hc_title(text = 'Thall Effect on Heart Attack') %>%
    hc_add_theme(hc_theme_google()) %>%
    hc_chart(options3d=list(enabled=TRUE, 
                            depth=100, viewDistance=25)) %>% 
    hc_plotOptions(column=list(depth= 100))
```
thall type 2 is more prone to heart attack and 1 and 3 is less risky to heart attack

```{r}
cor(heart)[,14]
```
We have positive correaltion with cp,restecg,thalachh,slp. The chance of heart attack will increase when cp increases and it is same for restecg, thalachh, and slp. For negative correlation, the chance of heart attack will increase when age is decreasing and that is same for the rest of negative correlations. 

##Using logliklihood of poisson distribution
#```{r}
#model = glm(output~1, family=poisson(link=log), data=heart)
#summary(model)
#model1 = glm(output~trtbps+chol+fbs+restecg, family=poisson(link=log), #data=heart)
#summary(model1)

#model2 = glm(output~age+sex+cp+trtbps+chol+fbs+restecg+thalachh+exng+oldpeak+sl#p+caa+thall, family=poisson(link=log), data=heart)
#summary(model2)

#anova(model, model1,model2, test="Chisq")
#```


